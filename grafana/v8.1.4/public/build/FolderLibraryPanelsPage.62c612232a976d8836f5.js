(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{"5gaU":function(e,n,t){"use strict";t.d(n,"d",(function(){return l})),t.d(n,"g",(function(){return u})),t.d(n,"c",(function(){return b})),t.d(n,"e",(function(){return p})),t.d(n,"h",(function(){return h})),t.d(n,"f",(function(){return j})),t.d(n,"a",(function(){return v})),t.d(n,"b",(function(){return m}));var i=t("Obii"),s=t("t8hP"),r=t("NXk7"),o=t("3SGO"),a=t("v2PB"),c=t("Xmxp"),d=t("BAXh");function l(e){return async n=>{const t=await r.b.getFolderByUid(e);n(Object(d.b)(t)),n(Object(o.d)(Object(a.a)(t)))}}function u(e){return async n=>{const t=await r.b.put("/api/folders/"+e.uid,{title:e.title,version:e.version});c.b.emit(i.AppEvents.alertSuccess,["Folder saved"]),s.locationService.push(t.url+"/settings")}}function b(e){return async n=>{await r.b.delete(`/api/folders/${e}?forceDeleteRules=true`),s.locationService.push("/dashboards")}}function p(e){return async n=>{const t=await r.b.get(`/api/folders/${e}/permissions`);n(Object(d.c)(t))}}function f(e){return{userId:e.userId,teamId:e.teamId,role:e.role,permission:e.permission}}function h(e,n){return async(t,i)=>{const s=i().folder,o=[];for(const t of s.permissions){if(t.inherited)continue;const i=f(t);e===t&&(i.permission=n),o.push(i)}await r.b.post(`/api/folders/${s.uid}/permissions`,{items:o}),await t(p(s.uid))}}function j(e){return async(n,t)=>{const i=t().folder,s=[];for(const n of i.permissions)n.inherited||n===e||s.push(f(n));await r.b.post(`/api/folders/${i.uid}/permissions`,{items:s}),await n(p(i.uid))}}function v(e){return async(n,t)=>{const i=t().folder,s=[];for(const e of i.permissions)e.inherited||s.push(f(e));s.push({userId:e.userId,teamId:e.teamId,role:e.role,permission:e.permission}),await r.b.post(`/api/folders/${i.uid}/permissions`,{items:s}),await n(p(i.uid))}}function m(e){return async()=>{const n=await Object(s.getBackendSrv)().post("/api/folders",{title:e});c.b.emit(i.AppEvents.alertSuccess,["Folder Created","OK"]),s.locationService.push(i.locationUtil.stripBaseFromUrl(n.url))}}},"Si+A":function(e,n,t){"use strict";t.r(n),t.d(n,"FolderLibraryPanelsPage",(function(){return h}));var i=t("q1tI"),s=t("/MKj"),r=t("Y8YH"),o=t("lzJ5"),a=t("v2PB"),c=t("ZGyg"),d=t("orvP"),l=t("huJC"),u=t("5gaU"),b=t("nKUr");const p={getFolderByUid:u.d},f=Object(s.connect)((e,n)=>{const t=n.match.params.uid;return{navModel:Object(o.a)(e.navIndex,"folder-library-panels-"+t,Object(a.b)(1)),folderUid:t,folder:e.folder}},p);function h({navModel:e,getFolderByUid:n,folderUid:t,folder:s}){const{loading:o}=Object(r.a)(async()=>await n(t),[n,t]),[a,u]=Object(i.useState)(void 0);return Object(b.jsx)(c.b,{navModel:e,children:Object(b.jsxs)(c.b.Contents,{isLoading:o,children:[Object(b.jsx)(d.a,{onClick:u,currentFolderId:s.id,showSecondaryActions:!0,showSort:!0,showPanelFilter:!0}),a?Object(b.jsx)(l.a,{onDismiss:()=>u(void 0),libraryPanel:a}):null]})})}n.default=f(h)},huJC:function(e,n,t){"use strict";t.d(n,"a",(function(){return b}));var i,s=t("q1tI"),r=t("vF1F"),o=t("kDLi"),a=t("Obii"),c=t("t8hP"),d=t("V8VS"),l=t("LvDl"),u=t("nKUr");function b({libraryPanel:e,onDismiss:n}){const t=Object(o.useStyles2)(p),[r,b]=Object(s.useState)(!1),[f,h]=Object(s.useState)(0),[j,v]=Object(s.useState)(void 0);Object(s.useEffect)(()=>{(async()=>{const n=await Object(d.e)(e.uid);h(n.length)})()},[e.uid]);const m=Object(s.useCallback)(n=>async function(e,n,t){t(!0);const i=(await Object(d.c)(e)).filter(e=>e.title.toLowerCase().includes(n.toLowerCase())).map(e=>({label:e.title,value:e}));return t(!1),i}(e.uid,n,b),[e.uid]),O=Object(s.useMemo)(()=>Object(l.debounce)(m,300,{leading:!0,trailing:!0}),[m]);return Object(u.jsxs)(o.Modal,{title:"View panel in dashboard",onDismiss:n,onClickBackdrop:n,isOpen:!0,children:[Object(u.jsxs)("div",{className:t.container,children:[0===f?i||(i=Object(u.jsx)("span",{children:"Panel is not linked to a dashboard. Add the panel to a dashboard and retry."})):null,f>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("p",{children:["This panel is being used in"," ",Object(u.jsxs)("strong",{children:[f," ",f>1?"dashboards":"dashboard"]}),".Please choose which dashboard to view the panel in:"]}),Object(u.jsx)(o.AsyncSelect,{menuShouldPortal:!0,isClearable:!0,isLoading:r,defaultOptions:!0,loadOptions:O,onChange:v,placeholder:"Start typing to search for dashboard",noOptionsMessage:"No dashboards found"})]}):null]}),Object(u.jsxs)(o.Modal.ButtonRow,{children:[Object(u.jsx)(o.Button,{variant:"secondary",onClick:n,fill:"outline",children:"Cancel"}),Object(u.jsx)(o.Button,{onClick:e=>{var n;e.preventDefault(),c.locationService.push(a.urlUtil.renderUrl("/d/"+(null==j||null===(n=j.value)||void 0===n?void 0:n.uid),{}))},disabled:!Boolean(j),children:j?`View panel in ${null==j?void 0:j.label}...`:"View panel in dashboard..."})]})]})}function p(e){return{container:r.css``}}},v2PB:function(e,n,t){"use strict";function i(e){const n={icon:"folder",id:"manage-folder",subTitle:"Manage folder dashboards and permissions",url:"",text:e.title,breadcrumbs:[{title:"Dashboards",url:"dashboards"}],children:[{active:!1,icon:"apps",id:"folder-dashboards-"+e.uid,text:"Dashboards",url:e.url}]};return n.children.push({active:!1,icon:"library-panel",id:"folder-library-panels-"+e.uid,text:"Panels",url:e.url+"/library-panels"}),e.canAdmin&&n.children.push({active:!1,icon:"lock",id:"folder-permissions-"+e.uid,text:"Permissions",url:e.url+"/permissions"}),e.canSave&&n.children.push({active:!1,icon:"cog",id:"folder-settings-"+e.uid,text:"Settings",url:e.url+"/settings"}),n}function s(e){const n=i({id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,version:0});return n.children[e].active=!0,{main:n,node:n.children[e]}}t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return s}))}}]);
//# sourceMappingURL=FolderLibraryPanelsPage.62c612232a976d8836f5.js.map