(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"5gaU":function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v}));var i=n("Obii"),s=n("t8hP"),r=n("NXk7"),o=n("3SGO"),a=n("v2PB"),d=n("Xmxp"),c=n("BAXh");function l(e){return async t=>{const n=await r.b.getFolderByUid(e);t(Object(c.b)(n)),t(Object(o.d)(Object(a.a)(n)))}}function u(e){return async t=>{const n=await r.b.put("/api/folders/"+e.uid,{title:e.title,version:e.version});d.b.emit(i.AppEvents.alertSuccess,["Folder saved"]),s.locationService.push(n.url+"/settings")}}function p(e){return async t=>{await r.b.delete(`/api/folders/${e}?forceDeleteRules=true`),s.locationService.push("/dashboards")}}function f(e){return async t=>{const n=await r.b.get(`/api/folders/${e}/permissions`);t(Object(c.c)(n))}}function h(e){return{userId:e.userId,teamId:e.teamId,role:e.role,permission:e.permission}}function b(e,t){return async(n,i)=>{const s=i().folder,o=[];for(const n of s.permissions){if(n.inherited)continue;const i=h(n);e===n&&(i.permission=t),o.push(i)}await r.b.post(`/api/folders/${s.uid}/permissions`,{items:o}),await n(f(s.uid))}}function m(e){return async(t,n)=>{const i=n().folder,s=[];for(const t of i.permissions)t.inherited||t===e||s.push(h(t));await r.b.post(`/api/folders/${i.uid}/permissions`,{items:s}),await t(f(i.uid))}}function g(e){return async(t,n)=>{const i=n().folder,s=[];for(const e of i.permissions)e.inherited||s.push(h(e));s.push({userId:e.userId,teamId:e.teamId,role:e.role,permission:e.permission}),await r.b.post(`/api/folders/${i.uid}/permissions`,{items:s}),await t(f(i.uid))}}function v(e){return async()=>{const t=await Object(s.getBackendSrv)().post("/api/folders",{title:e});d.b.emit(i.AppEvents.alertSuccess,["Folder Created","OK"]),s.locationService.push(i.locationUtil.stripBaseFromUrl(t.url))}}},kzsD:function(e,t,n){"use strict";n.r(t),n.d(t,"FolderSettingsPage",(function(){return w}));var i,s,r=n("q1tI"),o=n("/MKj"),a=n("kDLi"),d=n("ZGyg"),c=n("Xmxp"),l=n("lzJ5"),u=n("5gaU"),p=n("v2PB"),f=n("BAXh"),h=n("xAj+"),b=n("nKUr");function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const{Input:g}=a.LegacyForms,v={getFolderByUid:u.d,saveFolder:u.g,setFolderTitle:f.d,deleteFolder:u.c},j=Object(o.connect)((e,t)=>{const n=t.match.params.uid;return{navModel:Object(l.a)(e.navIndex,"folder-settings-"+n,Object(p.b)(2)),folderUid:n,folder:e.folder}},v);class w extends r.PureComponent{constructor(e){super(e),m(this,"onTitleChange",e=>{this.props.setFolderTitle(e.target.value)}),m(this,"onSave",async e=>{e.preventDefault(),e.stopPropagation(),this.setState({isLoading:!0}),await this.props.saveFolder(this.props.folder),this.setState({isLoading:!1})}),m(this,"onDelete",e=>{e.stopPropagation(),e.preventDefault();c.b.publish(new h.ShowConfirmModalEvent({title:"Delete",text:"Do you want to delete this folder and all its dashboards and alerts?",icon:"trash-alt",yesText:"Delete",onConfirm:()=>{this.props.deleteFolder(this.props.folder.uid)}}))}),this.state={isLoading:!1}}componentDidMount(){this.props.getFolderByUid(this.props.folderUid)}render(){const{navModel:e,folder:t}=this.props;return Object(b.jsx)(d.b,{navModel:e,children:Object(b.jsxs)(d.b.Contents,{isLoading:this.state.isLoading,children:[i||(i=Object(b.jsx)("h3",{className:"page-sub-heading",children:"Folder settings"})),Object(b.jsx)("div",{className:"section gf-form-group",children:Object(b.jsxs)("form",{name:"folderSettingsForm",onSubmit:this.onSave,children:[Object(b.jsxs)("div",{className:"gf-form",children:[s||(s=Object(b.jsx)("label",{className:"gf-form-label width-7",children:"Name"})),Object(b.jsx)(g,{type:"text",className:"gf-form-input width-30",value:t.title,onChange:this.onTitleChange})]}),Object(b.jsxs)("div",{className:"gf-form-button-row",children:[Object(b.jsx)(a.Button,{type:"submit",disabled:!t.canSave||!t.hasChanged,children:"Save"}),Object(b.jsx)(a.Button,{variant:"destructive",onClick:this.onDelete,disabled:!t.canSave,children:"Delete"})]})]})})]})})}}t.default=j(w)},v2PB:function(e,t,n){"use strict";function i(e){const t={icon:"folder",id:"manage-folder",subTitle:"Manage folder dashboards and permissions",url:"",text:e.title,breadcrumbs:[{title:"Dashboards",url:"dashboards"}],children:[{active:!1,icon:"apps",id:"folder-dashboards-"+e.uid,text:"Dashboards",url:e.url}]};return t.children.push({active:!1,icon:"library-panel",id:"folder-library-panels-"+e.uid,text:"Panels",url:e.url+"/library-panels"}),e.canAdmin&&t.children.push({active:!1,icon:"lock",id:"folder-permissions-"+e.uid,text:"Permissions",url:e.url+"/permissions"}),e.canSave&&t.children.push({active:!1,icon:"cog",id:"folder-settings-"+e.uid,text:"Settings",url:e.url+"/settings"}),t}function s(e){const t=i({id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,version:0});return t.children[e].active=!0,{main:t,node:t.children[e]}}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}))}}]);
//# sourceMappingURL=FolderSettingsPage.62c612232a976d8836f5.js.map