(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{FqDL:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a("q1tI"),s=a("batp");function l(e){const[t,a]=Object(n.useState)({items:[],interval:"5m",name:""}),[l,i]=Object(n.useState)(!0);return Object(n.useEffect)(()=>{(async()=>{if(!e)return void i(!1);const t=await Object(s.b)(e);a(t),i(!1)})()},[e]),{playlist:t,loading:l}}},Iue2:function(e,t,a){"use strict";a.r(t),a.d(t,"PlaylistEditPage",(function(){return j}));a("q1tI");var n=a("/MKj"),s=a("t8hP"),l=a("kDLi"),i=a("ZGyg"),r=a("lzJ5"),c=a("kTkl"),o=a("batp"),d=a("FqDL"),b=a("uvYg"),u=a("nKUr");const j=({navModel:e,match:t})=>{const a=Object(l.useStyles2)(b.a),{playlist:n,loading:r}=Object(d.a)(t.params.id);return Object(u.jsx)(i.b,{navModel:e,children:Object(u.jsxs)(i.b.Contents,{isLoading:r,children:[Object(u.jsx)("h3",{className:a.subHeading,children:"Edit playlist"}),Object(u.jsx)("p",{className:a.description,children:"A playlist rotates through a pre-selected list of dashboards. A playlist can be a great way to build situational awareness, or just show off your metrics to your team or visitors."}),Object(u.jsx)(c.a,{onSubmit:async e=>{await Object(o.c)(t.params.id,e),s.locationService.push("/playlists")},playlist:n})]})})};t.default=Object(n.connect)(e=>({navModel:Object(r.a)(e.navIndex,"playlists")}))(j)},batp:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return o}));var n=a("t8hP"),s=a("iODs"),l=a("3SGO"),i=a("UvM7");async function r(e){await d(async()=>await Object(n.getBackendSrv)().post("/api/playlists",e))}async function c(e,t){await d(async()=>await Object(n.getBackendSrv)().put("/api/playlists/"+e,t))}async function o(e){return await Object(n.getBackendSrv)().get("/api/playlists/"+e)}async function d(e){try{await e(),Object(s.a)(Object(l.b)(Object(i.b)("Playlist saved")))}catch(e){Object(s.a)(Object(l.b)(Object(i.a)("Unable to save playlist",e)))}}},kTkl:function(e,t,a){"use strict";var n=a("q1tI"),s=a("t8hP"),l=a("kDLi"),i=a("Csm0"),r=a("tpd9"),c=a("Z7m5"),o=a("mQDI");var d=a("vF1F"),b=a("rCnR"),u=a("nKUr");const j=({item:e,onDelete:t,onMoveDown:a,onMoveUp:n,first:s,last:r})=>{const c=Object(l.useStyles)(p);return Object(u.jsxs)("tr",{"aria-label":i.a.pages.PlaylistForm.itemRow,children:["dashboard_by_id"===e.type?Object(u.jsxs)("td",{className:Object(d.cx)(c.td,c.item),children:[Object(u.jsx)(l.Icon,{name:"apps","aria-label":i.a.pages.PlaylistForm.itemIdType}),Object(u.jsx)("span",{children:e.title})]}):null,"dashboard_by_tag"===e.type?Object(u.jsxs)("td",{className:Object(d.cx)(c.td,c.item),children:[Object(u.jsx)(l.Icon,{name:"tag-alt","aria-label":i.a.pages.PlaylistForm.itemTagType}),Object(u.jsx)(b.a,{label:e.title,removeIcon:!1,count:0},e.id)]}):null,Object(u.jsxs)("td",{className:Object(d.cx)(c.td,c.settings),children:[s?null:Object(u.jsx)(l.IconButton,{name:"arrow-up",size:"md",onClick:t=>{t.preventDefault(),n(e)},"aria-label":i.a.pages.PlaylistForm.itemMoveUp,type:"button"}),r?null:Object(u.jsx)(l.IconButton,{name:"arrow-down",size:"md",onClick:t=>{t.preventDefault(),a(e)},"aria-label":i.a.pages.PlaylistForm.itemMoveDown,type:"button"}),Object(u.jsx)(l.IconButton,{name:"times",size:"md",onClick:a=>{a.preventDefault(),t(e)},"aria-label":i.a.pages.PlaylistForm.itemDelete,type:"button"})]})]},e.title)};function p(e){return{td:d.css`
      label: td;
      line-height: 28px;
      max-width: 335px;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
    `,item:d.css`
      label: item;
      span {
        margin-left: ${e.spacing.xs};
      }
    `,settings:d.css`
      label: settings;
      text-align: right;
    `}}var m;const O=({items:e,onMoveUp:t,onMoveDown:a,onDelete:n})=>0===e.length?m||(m=Object(u.jsx)("tr",{children:Object(u.jsx)("td",{children:Object(u.jsx)("em",{children:"Playlist is empty. Add dashboards below."})})})):Object(u.jsx)(u.Fragment,{children:e.map((s,l)=>{const i=0===l,r=l===e.length-1;return Object(u.jsx)(j,{first:i,last:r,item:s,onDelete:n,onMoveDown:a,onMoveUp:t},s.title)})});var h;const v=({items:e,onMoveUp:t,onMoveDown:a,onDelete:n})=>Object(u.jsxs)("div",{className:"gf-form-group",children:[h||(h=Object(u.jsx)("h3",{className:"page-headering",children:"Dashboards"})),Object(u.jsx)("table",{className:"filter-table",children:Object(u.jsx)("tbody",{children:Object(u.jsx)(O,{items:e,onMoveUp:t,onMoveDown:a,onDelete:n})})})]});var g;function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}a.d(t,"a",(function(){return f}));const x=new o.a,f=({onSubmit:e,playlist:t})=>{var a,o;const{name:d,interval:b,items:j}=t,{items:p,addById:m,addByTag:O,deleteItem:h,moveDown:f,moveUp:w}=function(e){const[t,a]=Object(n.useState)(null!=e?e:[]),s=Object(n.useCallback)(e=>{if(t.find(t=>t.id===e.id))return;const n={id:e.id,title:e.label,type:"dashboard_by_id",value:e.id.toString(10),order:t.length+1};a([...t,n])},[t]),l=Object(n.useCallback)(e=>{const n=e[0];if(!n||t.find(e=>e.value===n))return;const s={title:n,type:"dashboard_by_tag",value:n,order:t.length+1};a([...t,s])},[t]),i=Object(n.useCallback)((e,n)=>{const s=[...t],l=s.indexOf(e),i=l+n;i>=0&&i<s.length&&(s.splice(l,1),s.splice(i,0,e)),a(s)},[t]),r=Object(n.useCallback)(e=>{i(e,-1)},[i]),c=Object(n.useCallback)(e=>{i(e,1)},[i]),o=Object(n.useCallback)(e=>{a(t.filter(t=>t!==e))},[t]);return{items:t,addById:s,addByTag:l,deleteItem:o,moveDown:c,moveUp:r}}(j);return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(l.Form,{onSubmit:t=>e(y({},t,{items:p})),validateOn:"onBlur",children:({register:e,errors:t})=>{var n,j;const D=0===p.length||Object.keys(t).length>0;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(l.Field,{label:"Name",invalid:!!t.name,error:null==t||null===(n=t.name)||void 0===n?void 0:n.message,children:Object(u.jsx)(l.Input,y({type:"text"},e("name",{required:"Name is required"}),{placeholder:"Name",defaultValue:d,"aria-label":i.a.pages.PlaylistForm.name}))}),Object(u.jsx)(l.Field,{label:"Interval",invalid:!!t.interval,error:null==t||null===(j=t.interval)||void 0===j?void 0:j.message,children:Object(u.jsx)(l.Input,y({type:"text"},e("interval",{required:"Interval is required"}),{placeholder:"5m",defaultValue:null!=b?b:"5m","aria-label":i.a.pages.PlaylistForm.interval}))}),a||(a=Object(u.jsx)(v,{items:p,onMoveUp:w,onMoveDown:f,onDelete:h})),Object(u.jsxs)("div",{className:"gf-form-group",children:[g||(g=Object(u.jsx)("h3",{className:"page-headering",children:"Add dashboards"})),o||(o=Object(u.jsx)(l.Field,{label:"Add by title",children:Object(u.jsx)(r.a,{onChange:m,isClearable:!0})})),Object(u.jsx)(l.Field,{label:"Add by tag",children:Object(u.jsx)(c.a,{isClearable:!0,tags:[],hideValues:!0,tagOptions:x.getDashboardTags,onChange:O,placeholder:""})})]}),Object(u.jsxs)(l.HorizontalGroup,{children:[Object(u.jsx)(l.Button,{variant:"primary",disabled:D,children:"Save"}),Object(u.jsx)(l.LinkButton,{variant:"secondary",href:s.config.appSubUrl+"/playlists",children:"Cancel"})]})]})}})})}},uvYg:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a("vF1F");function s(e){return{description:n.css`
      label: description;
      width: 555px;
      margin-bottom: 20px;
    `,subHeading:n.css`
      label: sub-heading;
      margin-bottom: ${e.spacing(2)};
    `}}}}]);
//# sourceMappingURL=PlaylistEditPage.62c612232a976d8836f5.js.map