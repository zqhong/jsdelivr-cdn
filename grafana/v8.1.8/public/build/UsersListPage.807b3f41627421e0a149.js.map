{"version":3,"sources":["webpack:///./public/app/features/users/UsersTable.tsx","webpack:///./public/app/features/users/InviteeRow.tsx","webpack:///./public/app/features/users/InviteesTable.tsx","webpack:///./public/app/features/users/UsersListPage.tsx","webpack:///./public/app/features/users/state/selectors.ts","webpack:///./public/app/features/users/state/actions.ts","webpack:///./public/app/features/users/UsersActionBar.tsx"],"names":["UsersTable","props","users","onRoleChange","onRemoveUser","canUpdateRole","contextSrv","hasPermission","AccessControlAction","OrgUsersRoleUpdate","canRemoveFromOrg","OrgUsersRemove","showRemoveModal","setShowRemoveModal","useState","className","style","width","map","user","index","src","avatarUrl","title","login","email","name","lastSeenAtAge","value","role","disabled","onChange","newRole","size","variant","onClick","icon","body","confirmText","onDismiss","isOpen","onConfirm","userId","InviteeRow","PureComponent","render","invitee","revokeInvite","this","getText","url","code","mapDispatchToProps","connect","InviteesTable","invitees","id","UsersListPage","constructor","super","updatedUser","updateUser","setState","prevState","showInvites","offset","searchPage","slice","externalUserMngInfo","externalUserMngInfoHtml","renderMarkdown","state","componentDidMount","fetchUsers","fetchInvitees","loadUsers","loadInvitees","renderTable","setUsersSearchPage","paginatedUsers","getPaginatedUsers","totalPages","Math","ceil","length","spacing","removeUser","justify","onNavigate","currentPage","numberOfPages","hideWhenSinglePage","navModel","hasFetched","Contents","isLoading","onShowInvites","dangerouslySetInnerHTML","__html","setUsersSearchQuery","hot","module","getNavModel","navIndex","getUsers","searchQuery","getUsersSearchQuery","getUsersSearchPage","getInvitees","regex","RegExp","filter","test","getInviteesCount","async","getBackendSrv","get","dispatch","usersLoaded","OrgUsersAdd","inviteesLoaded","patch","delete","UsersActionBar","canInvite","externalUserMngLinkName","externalUserMngLinkUrl","pendingInvitesCount","options","label","canAddToOrg","placeholder","marginLeft","href","target","rel"],"mappings":"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","file":"UsersListPage.807b3f41627421e0a149.js","sourcesContent":["import React, { FC, useState } from 'react';\nimport { AccessControlAction, OrgUser } from 'app/types';\nimport { OrgRolePicker } from '../admin/OrgRolePicker';\nimport { Button, ConfirmModal } from '@grafana/ui';\nimport { OrgRole } from '@grafana/data';\nimport { contextSrv } from 'app/core/core';\n\nexport interface Props {\n  users: OrgUser[];\n  onRoleChange: (role: OrgRole, user: OrgUser) => void;\n  onRemoveUser: (user: OrgUser) => void;\n}\n\nconst UsersTable: FC<Props> = (props) => {\n  const { users, onRoleChange, onRemoveUser } = props;\n  const canUpdateRole = contextSrv.hasPermission(AccessControlAction.OrgUsersRoleUpdate);\n  const canRemoveFromOrg = contextSrv.hasPermission(AccessControlAction.OrgUsersRemove);\n\n  const [showRemoveModal, setShowRemoveModal] = useState<string | boolean>(false);\n  return (\n    <table className=\"filter-table form-inline\">\n      <thead>\n        <tr>\n          <th />\n          <th>Login</th>\n          <th>Email</th>\n          <th>Name</th>\n          <th>Seen</th>\n          <th>Role</th>\n          <th style={{ width: '34px' }} />\n        </tr>\n      </thead>\n      <tbody>\n        {users.map((user, index) => {\n          return (\n            <tr key={`${user.userId}-${index}`}>\n              <td className=\"width-2 text-center\">\n                <img className=\"filter-table__avatar\" src={user.avatarUrl} />\n              </td>\n              <td className=\"max-width-6\">\n                <span className=\"ellipsis\" title={user.login}>\n                  {user.login}\n                </span>\n              </td>\n\n              <td className=\"max-width-5\">\n                <span className=\"ellipsis\" title={user.email}>\n                  {user.email}\n                </span>\n              </td>\n              <td className=\"max-width-5\">\n                <span className=\"ellipsis\" title={user.name}>\n                  {user.name}\n                </span>\n              </td>\n              <td className=\"width-1\">{user.lastSeenAtAge}</td>\n\n              <td className=\"width-8\">\n                <OrgRolePicker\n                  value={user.role}\n                  disabled={!canUpdateRole}\n                  onChange={(newRole) => onRoleChange(newRole, user)}\n                />\n              </td>\n\n              {canRemoveFromOrg && (\n                <td>\n                  <Button size=\"sm\" variant=\"destructive\" onClick={() => setShowRemoveModal(user.login)} icon=\"times\" />\n                  <ConfirmModal\n                    body={`Are you sure you want to delete user ${user.login}?`}\n                    confirmText=\"Delete\"\n                    title=\"Delete\"\n                    onDismiss={() => setShowRemoveModal(false)}\n                    isOpen={user.login === showRemoveModal}\n                    onConfirm={() => {\n                      onRemoveUser(user);\n                    }}\n                  />\n                </td>\n              )}\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n};\n\nexport default UsersTable;\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { Invitee } from 'app/types';\nimport { revokeInvite } from './state/actions';\nimport { Button, ClipboardButton } from '@grafana/ui';\n\nexport interface Props {\n  invitee: Invitee;\n  revokeInvite: typeof revokeInvite;\n}\n\nclass InviteeRow extends PureComponent<Props> {\n  render() {\n    const { invitee, revokeInvite } = this.props;\n    return (\n      <tr>\n        <td>{invitee.email}</td>\n        <td>{invitee.name}</td>\n        <td className=\"text-right\">\n          <ClipboardButton variant=\"secondary\" size=\"sm\" getText={() => invitee.url}>\n            Copy Invite\n          </ClipboardButton>\n          &nbsp;\n        </td>\n        <td>\n          <Button variant=\"destructive\" size=\"sm\" icon=\"times\" onClick={() => revokeInvite(invitee.code)} />\n        </td>\n      </tr>\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  revokeInvite,\n};\n\nexport default connect(() => {\n  return {};\n}, mapDispatchToProps)(InviteeRow);\n","import React, { PureComponent } from 'react';\nimport { Invitee } from 'app/types';\nimport InviteeRow from './InviteeRow';\n\nexport interface Props {\n  invitees: Invitee[];\n}\n\nexport default class InviteesTable extends PureComponent<Props> {\n  render() {\n    const { invitees } = this.props;\n\n    return (\n      <table className=\"filter-table form-inline\">\n        <thead>\n          <tr>\n            <th>Email</th>\n            <th>Name</th>\n            <th />\n            <th style={{ width: '34px' }} />\n          </tr>\n        </thead>\n        <tbody>\n          {invitees.map((invitee, index) => {\n            return <InviteeRow key={`${invitee.id}-${index}`} invitee={invitee} />;\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { hot } from 'react-hot-loader';\nimport { connect } from 'react-redux';\nimport { NavModel, renderMarkdown } from '@grafana/data';\nimport { HorizontalGroup, Pagination, VerticalGroup } from '@grafana/ui';\n\nimport Page from 'app/core/components/Page/Page';\nimport UsersActionBar from './UsersActionBar';\nimport UsersTable from './UsersTable';\nimport InviteesTable from './InviteesTable';\nimport { Invitee, OrgUser, OrgRole } from 'app/types';\nimport { loadInvitees, loadUsers, removeUser, updateUser } from './state/actions';\nimport { getNavModel } from 'app/core/selectors/navModel';\nimport { getInvitees, getUsers, getUsersSearchQuery, getUsersSearchPage } from './state/selectors';\nimport { setUsersSearchQuery, setUsersSearchPage } from './state/reducers';\n\nexport interface Props {\n  navModel: NavModel;\n  invitees: Invitee[];\n  users: OrgUser[];\n  searchQuery: string;\n  searchPage: number;\n  externalUserMngInfo: string;\n  hasFetched: boolean;\n  loadUsers: typeof loadUsers;\n  loadInvitees: typeof loadInvitees;\n  setUsersSearchQuery: typeof setUsersSearchQuery;\n  setUsersSearchPage: typeof setUsersSearchPage;\n  updateUser: typeof updateUser;\n  removeUser: typeof removeUser;\n}\n\nexport interface State {\n  showInvites: boolean;\n}\n\nconst pageLimit = 30;\n\nexport class UsersListPage extends PureComponent<Props, State> {\n  declare externalUserMngInfoHtml: string;\n\n  constructor(props: Props) {\n    super(props);\n\n    if (this.props.externalUserMngInfo) {\n      this.externalUserMngInfoHtml = renderMarkdown(this.props.externalUserMngInfo);\n    }\n\n    this.state = {\n      showInvites: false,\n    };\n  }\n\n  componentDidMount() {\n    this.fetchUsers();\n    this.fetchInvitees();\n  }\n\n  async fetchUsers() {\n    return await this.props.loadUsers();\n  }\n\n  async fetchInvitees() {\n    return await this.props.loadInvitees();\n  }\n\n  onRoleChange = (role: OrgRole, user: OrgUser) => {\n    const updatedUser = { ...user, role: role };\n\n    this.props.updateUser(updatedUser);\n  };\n\n  onShowInvites = () => {\n    this.setState((prevState) => ({\n      showInvites: !prevState.showInvites,\n    }));\n  };\n\n  getPaginatedUsers = (users: OrgUser[]) => {\n    const offset = (this.props.searchPage - 1) * pageLimit;\n    return users.slice(offset, offset + pageLimit);\n  };\n\n  renderTable() {\n    const { invitees, users, setUsersSearchPage } = this.props;\n    const paginatedUsers = this.getPaginatedUsers(users);\n    const totalPages = Math.ceil(users.length / pageLimit);\n\n    if (this.state.showInvites) {\n      return <InviteesTable invitees={invitees} />;\n    } else {\n      return (\n        <VerticalGroup spacing=\"md\">\n          <UsersTable\n            users={paginatedUsers}\n            onRoleChange={(role, user) => this.onRoleChange(role, user)}\n            onRemoveUser={(user) => this.props.removeUser(user.userId)}\n          />\n          <HorizontalGroup justify=\"flex-end\">\n            <Pagination\n              onNavigate={setUsersSearchPage}\n              currentPage={this.props.searchPage}\n              numberOfPages={totalPages}\n              hideWhenSinglePage={true}\n            />\n          </HorizontalGroup>\n        </VerticalGroup>\n      );\n    }\n  }\n\n  render() {\n    const { navModel, hasFetched } = this.props;\n    const externalUserMngInfoHtml = this.externalUserMngInfoHtml;\n\n    return (\n      <Page navModel={navModel}>\n        <Page.Contents isLoading={!hasFetched}>\n          <>\n            <UsersActionBar onShowInvites={this.onShowInvites} showInvites={this.state.showInvites} />\n            {externalUserMngInfoHtml && (\n              <div className=\"grafana-info-box\" dangerouslySetInnerHTML={{ __html: externalUserMngInfoHtml }} />\n            )}\n            {hasFetched && this.renderTable()}\n          </>\n        </Page.Contents>\n      </Page>\n    );\n  }\n}\n\nfunction mapStateToProps(state: any) {\n  return {\n    navModel: getNavModel(state.navIndex, 'users'),\n    users: getUsers(state.users),\n    searchQuery: getUsersSearchQuery(state.users),\n    searchPage: getUsersSearchPage(state.users),\n    invitees: getInvitees(state.users),\n    externalUserMngInfo: state.users.externalUserMngInfo,\n    hasFetched: state.users.hasFetched,\n  };\n}\n\nconst mapDispatchToProps = {\n  loadUsers,\n  loadInvitees,\n  setUsersSearchQuery,\n  setUsersSearchPage,\n  updateUser,\n  removeUser,\n};\n\nexport default hot(module)(connect(mapStateToProps, mapDispatchToProps)(UsersListPage));\n","import { UsersState } from 'app/types';\n\nexport const getUsers = (state: UsersState) => {\n  const regex = new RegExp(state.searchQuery, 'i');\n\n  return state.users.filter((user) => {\n    return regex.test(user.login) || regex.test(user.email) || regex.test(user.name);\n  });\n};\n\nexport const getInvitees = (state: UsersState) => {\n  const regex = new RegExp(state.searchQuery, 'i');\n\n  return state.invitees.filter((invitee) => {\n    return regex.test(invitee.name) || regex.test(invitee.email);\n  });\n};\n\nexport const getInviteesCount = (state: UsersState) => state.invitees.length;\nexport const getUsersSearchQuery = (state: UsersState) => state.searchQuery;\nexport const getUsersSearchPage = (state: UsersState) => state.searchPage;\n","import { AccessControlAction, ThunkResult } from '../../../types';\nimport { getBackendSrv } from '@grafana/runtime';\nimport { OrgUser } from 'app/types';\nimport { inviteesLoaded, usersLoaded } from './reducers';\nimport { contextSrv } from 'app/core/core';\n\nexport function loadUsers(): ThunkResult<void> {\n  return async (dispatch) => {\n    const users = await getBackendSrv().get('/api/org/users');\n    dispatch(usersLoaded(users));\n  };\n}\n\nexport function loadInvitees(): ThunkResult<void> {\n  return async (dispatch) => {\n    if (!contextSrv.hasPermission(AccessControlAction.OrgUsersAdd)) {\n      return;\n    }\n\n    const invitees = await getBackendSrv().get('/api/org/invites');\n    dispatch(inviteesLoaded(invitees));\n  };\n}\n\nexport function updateUser(user: OrgUser): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().patch(`/api/org/users/${user.userId}`, { role: user.role });\n    dispatch(loadUsers());\n  };\n}\n\nexport function removeUser(userId: number): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().delete(`/api/org/users/${userId}`);\n    dispatch(loadUsers());\n  };\n}\n\nexport function revokeInvite(code: string): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().patch(`/api/org/invites/${code}/revoke`, {});\n    dispatch(loadInvitees());\n  };\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { setUsersSearchQuery } from './state/reducers';\nimport { getInviteesCount, getUsersSearchQuery } from './state/selectors';\nimport { FilterInput } from 'app/core/components/FilterInput/FilterInput';\nimport { RadioButtonGroup, LinkButton } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction } from 'app/types';\n\nexport interface Props {\n  searchQuery: string;\n  setUsersSearchQuery: typeof setUsersSearchQuery;\n  onShowInvites: () => void;\n  pendingInvitesCount: number;\n  canInvite: boolean;\n  showInvites: boolean;\n  externalUserMngLinkUrl: string;\n  externalUserMngLinkName: string;\n}\n\nexport class UsersActionBar extends PureComponent<Props> {\n  render() {\n    const {\n      canInvite,\n      externalUserMngLinkName,\n      externalUserMngLinkUrl,\n      searchQuery,\n      pendingInvitesCount,\n      setUsersSearchQuery,\n      onShowInvites,\n      showInvites,\n    } = this.props;\n    const options = [\n      { label: 'Users', value: 'users' },\n      { label: `Pending Invites (${pendingInvitesCount})`, value: 'invites' },\n    ];\n    const canAddToOrg = contextSrv.hasPermission(AccessControlAction.OrgUsersAdd);\n\n    return (\n      <div className=\"page-action-bar\">\n        <div className=\"gf-form gf-form--grow\">\n          <FilterInput\n            value={searchQuery}\n            onChange={setUsersSearchQuery}\n            placeholder=\"Search user by login, email or name\"\n          />\n        </div>\n        {pendingInvitesCount > 0 && (\n          <div style={{ marginLeft: '1rem' }}>\n            <RadioButtonGroup value={showInvites ? 'invites' : 'users'} options={options} onChange={onShowInvites} />\n          </div>\n        )}\n        {canInvite && canAddToOrg && <LinkButton href=\"org/users/invite\">Invite</LinkButton>}\n        {externalUserMngLinkUrl && (\n          <LinkButton href={externalUserMngLinkUrl} target=\"_blank\" rel=\"noopener\">\n            {externalUserMngLinkName}\n          </LinkButton>\n        )}\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps(state: any) {\n  return {\n    searchQuery: getUsersSearchQuery(state.users),\n    pendingInvitesCount: getInviteesCount(state.users),\n    externalUserMngLinkName: state.users.externalUserMngLinkName,\n    externalUserMngLinkUrl: state.users.externalUserMngLinkUrl,\n    canInvite: state.users.canInvite,\n  };\n}\n\nconst mapDispatchToProps = {\n  setUsersSearchQuery,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UsersActionBar);\n"],"sourceRoot":""}