(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{RQDA:function(e,a,t){"use strict";t.r(a);var n=t("Obii"),r=t("F/XL"),l=t("p0ib"),s=t("0/uQ"),i=t("vubp"),o=t("t8hP");function d(e){if(0===e.indexOf("value"))return[{name:e,children:[]}];return function e(a,t,n){if(n>=t.length)return a;if("*"===t[n])return a;const r=t[n];let l=[],s=[r];r.startsWith("{")&&(s=r.replace(/\{|\}/g,"").split(","));for(const r of a)for(const a of s)if(-1!==a.indexOf("*")){const s=a.replace("*","");new RegExp(`^${s}.*`,"gi").test(r.name)&&(l=l.concat(e([r],t,n+1)))}else r.name===a&&(l=l.concat(e(r.children,t,n+1)));return l}(function e(a,t){const n=["A","B","C"],r=[];if(t>5)return[];for(const l of n){const n=`${a}${l}`;r.push({name:n,children:e(n,t+1)})}return r}("",0),e.split("."),0)}var u=t("LvDl"),c=t("6blF");let p=0;function m(){return p=(p+Math.floor(5*Math.random()))%h.length,h[p]}const h=["At","vero","eos","et","accusamus","et","iusto","odio","dignissimos","ducimus","qui","blanditiis","praesentium","voluptatum","deleniti","atque","corrupti","quos","dolores","et","quas","molestias","excepturi","sint","occaecati","cupiditate","non","provident","similique","sunt","in","culpa","qui","officia","deserunt","mollitia","animi","id","est","laborum","et","dolorum","fuga","Et","harum","quidem","rerum","facilis","est","et","expedita","distinctio","Nam","libero","tempore","cum","soluta","nobis","est","eligendi","optio","cumque","nihil","impedit","quo","minus","id","quod","maxime","placeat","facere","possimus","omnis","voluptas","assumenda","est","omnis","dolor","repellendus","Temporibus","autem","quibusdam","et","aut","officiis","debitis","aut","rerum","necessitatibus","saepe","eveniet","ut","et","voluptates","repudiandae","sint","et","molestiae","non","recusandae","Itaque","earum","rerum","hic","tenetur","a","sapiente","delectus","ut","aut","reiciendis","voluptatibus","maiores","alias","consequatur","aut","perferendis","doloribus","asperiores","repellat"];var b=t("PQ0n");const v={type:"signal",speed:250,spread:3.5,noise:2.2,bands:1};function g(e,a){const t=Object(u.defaults)(e.stream,v);if("signal"===t.type)return function(e,a,t){return new c.a(r=>{const l=`signal-${t.panelId}-${e.refId}`,s=t.maxDataPoints||1e3,i={refId:e.refId,name:e.alias||"Signal "+e.refId,fields:[{name:"time",type:n.FieldType.time},{name:"value",type:n.FieldType.number}]},{spread:o,speed:d,bands:u=0,noise:c}=a;for(let e=0;e<u;e++){const a=u>1?" "+(e+1):"";i.fields.push({name:"Min"+a,type:n.FieldType.number}),i.fields.push({name:"Max"+a,type:n.FieldType.number})}const p=new n.StreamingDataFrame({schema:i},{maxLength:s});let m=100*Math.random(),h=null,v=-1;const g=e=>{m+=(Math.random()-.5)*o;const a={values:[[e],[m]]};let t=m,n=m;for(let e=0;e<u;e++)t-=Math.random()*c,n+=Math.random()*c,a.values.push([t]),a.values.push([n]);const r={data:a};return p.push(r)};{let e=Date.now()-s*d;for(let a=0;a<s;a++)g(e),e+=d}const f=()=>{g(Date.now());(b.a.last-v>1e3||b.a.ok)&&(r.next({data:[p],key:l,state:n.LoadingState.Streaming}),v=b.a.last),h=setTimeout(f,d)};return setTimeout(f,5),()=>{console.log("unsubscribing to stream "+l),clearTimeout(h)}})}(e,t,a);if("logs"===t.type)return function(e,a,t){return new c.a(r=>{const l=`logs-${t.panelId}-${e.refId}`,s=t.maxDataPoints||1e3,i=new n.CircularDataFrame({append:"tail",capacity:s});i.refId=e.refId,i.name=e.alias||"Logs "+e.refId,i.addField({name:"line",type:n.FieldType.string}),i.addField({name:"time",type:n.FieldType.time}),i.meta={preferredVisualisationType:"logs"};const{speed:o}=a;let d=null;const u=()=>{i.fields[0].values.add(Date.now()),i.fields[1].values.add(function(e=60){let a=m();for(;a.length<e;)a+=" "+m();return a}()),r.next({data:[i],key:l}),d=setTimeout(u,o)};return setTimeout(u,5),()=>{console.log("unsubscribing to stream "+l),clearTimeout(d)}})}(e,t,a);if("fetch"===t.type)return function(e,a,t){return new c.a(r=>{const l=`fetch-${t.panelId}-${e.refId}`,s=t.maxDataPoints||1e3;let i,o=new n.CircularDataFrame({append:"tail",capacity:s});o.refId=e.refId,o.name=e.alias||"Fetch "+e.refId;const d=new n.CSVReader({callback:{onHeader:a=>{o.fields.length&&(o=new n.CircularDataFrame({append:"tail",capacity:s}),o.refId=e.refId,o.name="Fetch "+e.refId);for(const e of a)o.addField(e)},onRow:e=>{o.add(e)}}}),u=e=>{if(e.value){const a=(new TextDecoder).decode(e.value);d.readCSV(a)}return r.next({data:[o],key:l,state:e.done?n.LoadingState.Done:n.LoadingState.Streaming}),e.done?(console.log("Finished stream"),void r.complete()):i.read().then(u)};if(!a.url)throw new Error("query.url is not defined");return fetch(new Request(a.url)).then(e=>{e.body&&(i=e.body.getReader(),i.read().then(u))}),()=>{console.log("unsubscribing to stream "+l)}})}(e,t,a);throw new Error("Unknown Stream Type: "+t.type)}var f=t("+JjO");class y extends n.StandardVariableSupport{toDataQuery(e){return{refId:"TestDataDataSource-QueryVariable",stringInput:e.query,scenarioId:"variables-query",csvWave:void 0}}}const j={fields:[{name:n.NodeGraphDataFrameFieldNames.id,type:n.FieldType.string,config:{links:[{title:"Traces/All",url:"",internal:{query:{queryType:"getTraceSummaries",query:'service(id(name: "${__data.fields.name}", type: "${__data.fields.type}"))'},datasourceUid:"Ax4erxHGz",datasourceName:"Trace data source"}},{title:"Traces/OK",url:"",internal:{query:{queryType:"getTraceSummaries",query:'service(id(name: "${__data.fields.name}", type: "${__data.fields.type}")) { ok = true }'},datasourceUid:"Ax4erxHGz",datasourceName:"Trace data source"}},{title:"Traces/Errors",url:"",internal:{query:{queryType:"getTraceSummaries",query:'service(id(name: "${__data.fields.name}", type: "${__data.fields.type}")) { error = true }'},datasourceUid:"Ax4erxHGz",datasourceName:"Trace data source"}},{title:"Traces/Faults",url:"",internal:{query:{queryType:"getTraceSummaries",query:'service(id(name: "${__data.fields.name}", type: "${__data.fields.type}")) { fault = true }'},datasourceUid:"Ax4erxHGz",datasourceName:"Trace data source"}}]},values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{name:n.NodeGraphDataFrameFieldNames.title,type:n.FieldType.string,config:{displayName:"Name"},values:["auth","products","customers","orders","products","orders","api","shipping","orders","execute-api","shipping","www","api","www","products"]},{name:n.NodeGraphDataFrameFieldNames.subTitle,type:n.FieldType.string,config:{displayName:"Type"},values:["Compute","SQL","SQL","SQL","remote","Function","Compute","Function","Function","remote","Function","Compute","client","client","Compute"]},{name:n.NodeGraphDataFrameFieldNames.mainStat,type:n.FieldType.number,config:{unit:"ms/t",displayName:"Average response time"},values:[3.5394042646735553,15.906441318223264,4.913011921591567,7.4163203042094095,1092,22.85961441405067,56.135855729084696,4.45946191601527,12.818300278280843,4.25,12.565442646791492,77.63447512700567,40.387096774193544,77.63447512700567,27.648950187374872]},{name:n.NodeGraphDataFrameFieldNames.secondaryStat,type:n.FieldType.number,config:{unit:"t/min",displayName:"Transactions per minute"},values:[50.56317154501667,682.4,512.8416666666667,125.64444444444445,.005585812037424941,137.59722222222223,300.0527777777778,30.582348853370394,125.77222222222223,.028706417080318163,30.582348853370394,165.675,.100021510002151,165.675,162.33055555555555]},{name:n.NodeGraphDataFrameFieldNames.arc+"success",type:n.FieldType.number,config:{color:{mode:n.FieldColorModeId.Fixed,fixedColor:"green"},displayName:"Sucesss"},values:[.9338865684765882,1,1,1,.5,1,.9901128505170387,.9069260134520997,1,0,.9069260134520997,.9624432037288534,0,.9624432037288534,.9824945669843769]},{name:n.NodeGraphDataFrameFieldNames.arc+"faults",type:n.FieldType.number,config:{color:{mode:n.FieldColorModeId.Fixed,fixedColor:"red"},displayName:"Faults"},values:[0,0,0,0,.5,0,.009479813736472288,0,0,0,0,.017168821152524185,0,.017168821152524185,.01750543301562313]},{name:n.NodeGraphDataFrameFieldNames.arc+"errors",type:n.FieldType.number,config:{color:{mode:n.FieldColorModeId.Fixed,fixedColor:"semi-dark-yellow"},displayName:"Errors"},values:[.06611343152341174,0,0,0,0,0,.0004073357464890436,.09307398654790038,0,1,.09307398654790038,.02038797511862247,1,.02038797511862247,0]},{name:n.NodeGraphDataFrameFieldNames.arc+"throttled",type:n.FieldType.number,config:{color:{mode:n.FieldColorModeId.Fixed,fixedColor:"purple"},displayName:"Throttled"},values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}],meta:{preferredVisualisationType:"nodeGraph"},name:"nodes"},F={fields:[{name:n.NodeGraphDataFrameFieldNames.id,type:n.FieldType.string,config:{links:[{title:"Traces/All",url:"",internal:{query:{queryType:"getTraceSummaries",query:'edge("${__data.fields.sourceName}", "${__data.fields.targetName}")'},datasourceUid:"Ax4erxHGz",datasourceName:"Trace data source"}},{title:"Traces/OK",url:"",internal:{query:{queryType:"getTraceSummaries",query:'edge("${__data.fields.sourceName}", "${__data.fields.targetName}") { ok = true }'},datasourceUid:"Ax4erxHGz",datasourceName:"Trace data source"}},{title:"Traces/Errors",url:"",internal:{query:{queryType:"getTraceSummaries",query:'edge("${__data.fields.sourceName}", "${__data.fields.targetName}") { error = true }'},datasourceUid:"Ax4erxHGz",datasourceName:"Trace data source"}},{title:"Traces/Faults",url:"",internal:{query:{queryType:"getTraceSummaries",query:'edge("${__data.fields.sourceName}", "${__data.fields.targetName}") { fault = true }'},datasourceUid:"Ax4erxHGz",datasourceName:"Trace data source"}}]},values:["0__2","5__8","6__0","6__5","6__9","6__2","6__14","6__4","8__3","10__7","11__0","11__6","12__6","13__11","14__1","14__2","14__10"]},{name:n.NodeGraphDataFrameFieldNames.source,type:n.FieldType.string,config:{},values:[0,5,6,6,6,6,6,6,8,10,11,11,12,13,14,14,14]},{name:"sourceName",type:n.FieldType.string,config:{},values:["auth","orders","api","api","api","api","api","api","orders","shipping","www","www","api","www","products","products","products"]},{name:n.NodeGraphDataFrameFieldNames.target,type:n.FieldType.string,config:{},values:[2,8,0,5,9,2,14,4,3,7,0,6,6,11,1,2,10]},{name:"targetName",type:n.FieldType.string,config:{},values:["customers","orders","auth","orders","execute-api","customers","products","products","orders","shipping","auth","api","api","www","products","customers","shipping"]},{name:n.NodeGraphDataFrameFieldNames.mainStat,type:n.FieldType.string,config:{displayName:"Response percentage"},values:["Success 100.00%","Success 100.00%","Success 100.00%","Success 100.00%","Errors 100.00%","Success 100.00%","Faults 1.75%","Faults 50.00%","Success 100.00%","Errors 9.31%","Errors 6.62%","Faults 1.13%","Errors 100.00%","Faults 1.72%","Success 100.00%","Success 100.00%","Faults 9.30%"]},{name:n.NodeGraphDataFrameFieldNames.secondaryStat,type:n.FieldType.number,config:{unit:"t/min",displayName:"Transactions per minute"},values:[50.56317154501667,125.77222222222223,.03333333333333333,137.59722222222223,.022222222222222223,299.96666666666664,162.33055555555555,.005555555555555556,125.64444444444445,30.582348853370394,50.51111111111111,299.9166666666667,.100021510002151,165.675,682.4,162.33055555555555,30.558333333333334]}],meta:{preferredVisualisationType:"nodeGraph"},name:"edges"};function x(){return(x=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function O(e){const a=Math.random(),t=1-a;return{id:e.toString(),title:"service:"+e,subTitle:"service",success:a,error:t,stat1:Math.random(),stat2:Math.random(),edges:[]}}function w(){return(w=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}class C extends o.DataSourceWithBackend{constructor(e,a=Object(o.getTemplateSrv)()){var t,n,r;super(e),r=void 0,(n="scenariosCache")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,this.templateSrv=a,this.variables=new y}query(e){const a=[],t=[];for(const n of e.targets)if(!n.hide)switch(this.resolveTemplateVariables(n,e.scopedVars),n.scenarioId){case"live":t.push(S(n,e));break;case"streaming_client":t.push(g(n,e));break;case"grafana_api":t.push(I(n,e));break;case"annotations":t.push(this.annotationDataTopicTest(n,e));break;case"variables-query":t.push(this.variablesQuery(n,e));break;case"node_graph":t.push(this.nodesQuery(n,e));break;case"manual_entry":{let e="Time,Value\n";if(n.points)for(const a of n.points)e+=`${a[1]},${a[0]}\n`;n.scenarioId="csv_content",n.csvContent=e}default:n.alias&&(n.alias=this.templateSrv.replace(n.alias,e.scopedVars)),a.push(n)}if(a.length){const n=w({},e,{targets:a});t.push(super.query(n))}return 0===t.length?Object(r.a)({data:[]}):Object(l.a)(...t)}resolveTemplateVariables(e,a){e.labels=this.templateSrv.replace(e.labels,a)}annotationDataTopicTest(e,a){const t=this.buildFakeAnnotationEvents(a.range,10),l=new n.ArrayDataFrame(t);return l.meta={dataTopic:n.DataTopic.Annotations},Object(r.a)({key:e.refId,data:[l]}).pipe(Object(i.a)(100))}buildFakeAnnotationEvents(e,a){let t=e.from.valueOf();const n=[],r=(e.to.valueOf()-t)/a;for(let e=0;e<a;e++)n.push({time:t,text:'This is the text, <a href="https://grafana.com">Grafana.com</a>',tags:["text","server"]}),t+=r;return n}annotationQuery(e){return Promise.resolve(this.buildFakeAnnotationEvents(e.range,10))}getQueryDisplayText(e){return e.alias?e.scenarioId+" as "+e.alias:e.scenarioId}testDatasource(){return Promise.resolve({status:"success",message:"Data source is working"})}getScenarios(){return this.scenariosCache||(this.scenariosCache=this.getResource("scenarios")),this.scenariosCache}variablesQuery(e,a){var t;const l=null!==(t=e.stringInput)&&void 0!==t?t:"",s=d(this.templateSrv.replace(l,Object(f.g)({query:l,wildcardChar:"*",options:a.scopedVars}))).map(e=>({value:e.name,text:e.name})),o=new n.ArrayDataFrame(s);return Object(r.a)({data:[o]}).pipe(Object(i.a)(100))}nodesQuery(e,a){var t,l;const s=(null===(t=e.nodes)||void 0===t?void 0:t.type)||"random";let o;switch(s){case"random":o=function(e=10){const a=[],t={id:"0",title:"root",subTitle:"client",success:1,error:0,stat1:Math.random(),stat2:Math.random(),edges:[]};a.push(t);const r=[t];for(let t=1;t<e;t++){const e=O(t);a.push(e);const n=Math.floor(Math.random()*Math.floor(r.length-1)),l=r[n];l.edges.push(e.id),l.edges.length>=3&&r.splice(n,1),r.push(e)}const l=Math.floor(e/2);for(let e=0;e<=l;e++){const e=Math.floor(Math.random()*Math.floor(a.length-1));e!==Math.floor(Math.random()*Math.floor(a.length-1))&&"0"!==a[e].id&&"0"!==a[e].id&&a[e].edges.push(a[e].id)}const s={[n.NodeGraphDataFrameFieldNames.id]:{values:new n.ArrayVector,type:n.FieldType.string},[n.NodeGraphDataFrameFieldNames.title]:{values:new n.ArrayVector,type:n.FieldType.string},[n.NodeGraphDataFrameFieldNames.subTitle]:{values:new n.ArrayVector,type:n.FieldType.string},[n.NodeGraphDataFrameFieldNames.mainStat]:{values:new n.ArrayVector,type:n.FieldType.number,config:{displayName:"Transactions per second"}},[n.NodeGraphDataFrameFieldNames.secondaryStat]:{values:new n.ArrayVector,type:n.FieldType.number,config:{displayName:"Average duration"}},[n.NodeGraphDataFrameFieldNames.arc+"success"]:{values:new n.ArrayVector,type:n.FieldType.number,config:{color:{fixedColor:"green",mode:n.FieldColorModeId.Fixed},displayName:"Success"}},[n.NodeGraphDataFrameFieldNames.arc+"errors"]:{values:new n.ArrayVector,type:n.FieldType.number,config:{color:{fixedColor:"red",mode:n.FieldColorModeId.Fixed},displayName:"Errors"}}},i=new n.MutableDataFrame({name:"nodes",fields:Object.keys(s).map(e=>x({},s[e],{name:e})),meta:{preferredVisualisationType:"nodeGraph"}}),o={[n.NodeGraphDataFrameFieldNames.id]:{values:new n.ArrayVector,type:n.FieldType.string},[n.NodeGraphDataFrameFieldNames.source]:{values:new n.ArrayVector,type:n.FieldType.string},[n.NodeGraphDataFrameFieldNames.target]:{values:new n.ArrayVector,type:n.FieldType.string}},d=new n.MutableDataFrame({name:"edges",fields:Object.keys(o).map(e=>x({},o[e],{name:e})),meta:{preferredVisualisationType:"nodeGraph"}}),u=new Set;for(const e of a){s.id.values.add(e.id),s.title.values.add(e.title),s.subTitle.values.add(e.subTitle),s.mainStat.values.add(e.stat1),s.secondaryStat.values.add(e.stat2),s.arc__success.values.add(e.success),s.arc__errors.values.add(e.error);for(const a of e.edges){const t=`${e.id}--${a}`;u.has(t)||(u.add(t),o.id.values.add(`${e.id}--${a}`),o.source.values.add(e.id),o.target.values.add(a))}}return[i,d]}(null===(l=e.nodes)||void 0===l?void 0:l.count);break;case"response":o=[new n.MutableDataFrame(j),new n.MutableDataFrame(F)];break;default:throw new Error("Unknown node_graph sub type "+s)}return Object(r.a)({data:o}).pipe(Object(i.a)(100))}}function I(e,a){const t="/api/"+e.stringInput;return Object(s.a)(Object(o.getBackendSrv)().get(t).then(e=>{const a=new n.ArrayDataFrame(e);return{state:n.LoadingState.Done,data:[a]}}))}let T=1e3;function S(e,a){if(!e.channel)throw new Error("Missing channel config");return Object(o.getGrafanaLiveSrv)().getDataStream({addr:{scope:n.LiveChannelScope.Plugin,namespace:"testdata",path:e.channel},key:"testStream."+T++})}var _,N,D=t("q1tI"),q=t("kDLi"),k=t("nKUr");class A extends D.PureComponent{constructor(e){super(e)}render(){return _||(_=Object(k.jsxs)("div",{children:["See github for more information about setting up a reproducible test environment.",Object(k.jsx)("br",{}),Object(k.jsx)("br",{}),Object(k.jsx)(q.LinkButton,{variant:"secondary",href:"https://github.com/grafana/grafana/tree/main/devenv",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),Object(k.jsx)("br",{})]}))}}class M extends D.PureComponent{render(){return N||(N=Object(k.jsx)("div",{}))}}var V=t("Y8YH"),$=t("Csm0");const G=[{label:"Speed (ms)",id:"speed",placeholder:"value",min:10,step:10},{label:"Spread",id:"spread",placeholder:"value",min:.5,step:.1},{label:"Noise",id:"noise",placeholder:"value",min:0,step:.1},{label:"Bands",id:"bands",placeholder:"bands",min:0,step:1}],P=[{value:"signal",label:"Signal"},{value:"logs",label:"Logs"},{value:"fetch",label:"Fetch"}],W=({onChange:e,query:a})=>{var t,n,r;const l=a=>{const{name:t,value:n}=a.target;e({target:{name:t,value:Number(n)}})};return Object(k.jsxs)(q.InlineFieldRow,{children:[Object(k.jsx)(q.InlineField,{label:"Type",labelWidth:14,children:Object(k.jsx)(q.Select,{menuShouldPortal:!0,width:32,onChange:({value:a})=>{e({target:{name:"type",value:a}})},defaultValue:P[0],options:P})}),"signal"===(null==a||null===(t=a.stream)||void 0===t?void 0:t.type)&&G.map(({label:e,id:t,min:n,step:r,placeholder:s})=>{var i;return Object(k.jsx)(q.InlineField,{label:e,labelWidth:14,children:Object(k.jsx)(q.Input,{width:32,type:"number",id:`stream.${t}-${a.refId}`,name:t,min:n,step:r,value:null===(i=a.stream)||void 0===i?void 0:i[t],placeholder:s,onChange:l})},t)}),"fetch"===(null==a||null===(n=a.stream)||void 0===n?void 0:n.type)&&Object(k.jsx)(q.InlineField,{label:"URL",labelWidth:14,grow:!0,children:Object(k.jsx)(q.Input,{type:"text",name:"url",id:"stream.url-"+a.refId,value:null==a||null===(r=a.stream)||void 0===r?void 0:r.url,placeholder:"Fetch URL",onChange:e})})]})},L=[{label:"Series count",id:"seriesCount",placeholder:"1",min:1,step:1},{label:"Start value",id:"startValue",placeholder:"auto",step:1},{label:"Spread",id:"spread",placeholder:"1",min:.5,step:.1},{label:"Noise",id:"noise",placeholder:"0",min:0,step:.1},{label:"Min",id:"min",placeholder:"none",step:.1},{label:"Max",id:"max",placeholder:"none",step:.1}],R=$.a.components.DataSource.TestData.QueryTab,E=({onChange:e,query:a})=>Object(k.jsx)(q.InlineFieldRow,{children:L.map(({label:t,id:n,min:r,step:l,placeholder:s})=>{const i=null==R?void 0:R[n];return Object(k.jsx)(q.InlineField,{label:t,labelWidth:14,"aria-label":i,children:Object(k.jsx)(q.Input,{width:32,name:n,type:"number",id:`randomWalk-${n}-${a.refId}`,min:r,step:l,value:a[n]||s,placeholder:s,onChange:e})},n)})}),Q=[{label:"Step",id:"timeStep",placeholder:"60",tooltip:"The number of seconds between datapoints."},{label:"On Count",id:"onCount",placeholder:"3",tooltip:"The number of values within a cycle, at the start of the cycle, that should have the onValue."},{label:"Off Count",id:"offCount",placeholder:"6",tooltip:"The number of offValues within the cycle."},{label:"On Value",id:"onValue",placeholder:"1",tooltip:'The value for "on values", may be an int, float, or null.'},{label:"Off Value",id:"offValue",placeholder:"1",tooltip:'The value for "off values", may be a int, float, or null.'}],H=({onChange:e,query:a})=>{const t=a=>{const{name:t,value:n}=a.target;e({target:{name:t,value:Number(n)}})};return Object(k.jsx)(q.InlineFieldRow,{children:Q.map(({label:e,id:n,placeholder:r,tooltip:l})=>{var s;return Object(k.jsx)(q.InlineField,{label:e,labelWidth:14,tooltip:l,children:Object(k.jsx)(q.Input,{width:32,type:"number",name:n,id:`pulseWave.${n}-${a.refId}`,value:null===(s=a.pulseWave)||void 0===s?void 0:s[n],placeholder:r,onChange:t})},n)})})},U={timeStep:60,onCount:3,onValue:2,offCount:3,offValue:1},z=[{timeStep:60,valuesCSV:"0,0,2,2,1,1"}],B={scenarioId:"random_walk",refId:""};function K(){return(K=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function Y(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class J extends D.PureComponent{constructor(...e){super(...e),Y(this,"onFieldChange",e=>a=>{const{value:t}=a.target;this.props.onChange(this.props.index,K({},this.props.wave,{[e]:t}))}),Y(this,"onNameChange",this.onFieldChange("name")),Y(this,"onLabelsChange",this.onFieldChange("labels")),Y(this,"onCSVChange",this.onFieldChange("valuesCSV")),Y(this,"onTimeStepChange",e=>{const a=e.target.valueAsNumber;this.props.onChange(this.props.index,K({},this.props.wave,{timeStep:a}))})}render(){const{wave:e,last:a}=this.props;let t=this.props.onAdd;return a||(t=()=>{this.props.onChange(this.props.index,void 0)}),Object(k.jsxs)(q.InlineFieldRow,{children:[Object(k.jsx)(q.InlineField,{label:"Values",grow:!0,tooltip:"Comma separated values. Each value may be an int, float, or null and must not be empty. Whitespace and trailing commas are removed",children:Object(k.jsx)(q.Input,{value:e.valuesCSV,placeholder:"CSV values",onChange:this.onCSVChange,autoFocus:!0})}),Object(k.jsx)(q.InlineField,{label:"Step",tooltip:"The number of seconds between datapoints.",children:Object(k.jsx)(q.Input,{value:e.timeStep,type:"number",placeholder:"60",width:6,onChange:this.onTimeStepChange})}),Object(k.jsx)(q.InlineField,{label:"Labels",children:Object(k.jsx)(q.Input,{value:e.labels,placeholder:"labels",width:12,onChange:this.onLabelsChange})}),Object(k.jsx)(q.InlineField,{label:"Name",children:Object(k.jsx)(q.Input,{value:e.name,placeholder:"name",width:10,onChange:this.onNameChange})}),Object(k.jsx)(q.Button,{icon:a?"plus":"minus",variant:"secondary",onClick:t})]})}}class X extends D.PureComponent{constructor(...e){super(...e),Y(this,"onChange",(e,a)=>{var t;let n=[...null!==(t=this.props.waves)&&void 0!==t?t:z];a?n[e]=K({},a):n.splice(e,1),this.props.onChange(n)}),Y(this,"onAdd",()=>{var e;const a=[...null!==(e=this.props.waves)&&void 0!==e?e:z];a.push(K({},z[0])),this.props.onChange(a)})}render(){var e;let a=null!==(e=this.props.waves)&&void 0!==e?e:z;return a.length||(a=z),Object(k.jsx)(k.Fragment,{children:a.map((e,t)=>Object(k.jsx)(J,{wave:e,index:t,onAdd:this.onAdd,onChange:this.onChange,last:t===a.length-1},`${t}/${e.valuesCSV}`))})}}function Z(){return(Z=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}const ee=[{label:"random-2s-stream",value:"random-2s-stream",description:"Random stream with points every 2s"},{label:"random-flakey-stream",value:"random-flakey-stream",description:"Stream that returns data in random intervals"},{label:"random-20Hz-stream",value:"random-20Hz-stream",description:"Random stream with points in 20Hz"}],ae=({onChange:e,query:a})=>Object(k.jsx)(q.InlineFieldRow,{children:Object(k.jsx)(q.InlineField,{label:"Channel",labelWidth:14,children:Object(k.jsx)(q.Select,{menuShouldPortal:!0,width:32,onChange:({value:t})=>{e(Z({},a,{channel:t}))},placeholder:"Select channel",options:ee,value:ee.find(e=>e.value===a.channel)})})});function te(){return(te=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function ne({query:e,onChange:a}){var t,n;const r=(null===(t=e.nodes)||void 0===t?void 0:t.type)||"random";return Object(k.jsxs)(q.InlineFieldRow,{children:[Object(k.jsx)(q.InlineField,{label:"Data type",labelWidth:14,children:Object(k.jsx)(q.Select,{options:re.map(e=>({label:e,value:e})),value:re.find(e=>e===r),onChange:t=>a(te({},e.nodes,{type:t.value})),width:32})}),"random"===r&&Object(k.jsx)(q.InlineField,{label:"Count",labelWidth:14,children:Object(k.jsx)(q.Input,{type:"number",name:"count",value:null===(n=e.nodes)||void 0===n?void 0:n.count,width:32,onChange:t=>a(te({},e.nodes,{count:t.currentTarget.value?parseInt(t.currentTarget.value,10):0})),placeholder:"10"})})]})}const re=["random","response"];function le(){return(le=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}const se=({onChange:e,query:a})=>{const t=["flight_info_by_state.csv","population_by_state.csv","gdp_per_capita.csv","js_libraries.csv","weight_height.csv","browser_marketshare.csv"].map(e=>({label:e,value:e}));return Object(k.jsx)(q.InlineFieldRow,{children:Object(k.jsx)(q.InlineField,{label:"File",labelWidth:14,children:Object(k.jsx)(q.Select,{menuShouldPortal:!0,width:32,onChange:({value:t})=>{e(le({},a,{csvFileName:t}))},placeholder:"Select csv file",options:t,value:t.find(e=>e.value===a.csvFileName)})})})};function ie(){return(ie=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}const oe=({onChange:e,query:a})=>{var t;return Object(k.jsx)(q.InlineField,{label:"CSV",labelWidth:14,children:Object(k.jsx)(q.TextArea,{width:"100%",rows:10,onBlur:t=>{e(ie({},a,{csvContent:t.currentTarget.value}))},placeholder:"CSV content",defaultValue:null!==(t=a.csvContent)&&void 0!==t?t:""})})};function de(){return(de=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function ue({query:e,onChange:a}){return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(q.InlineFieldRow,{children:[Object(k.jsx)(q.InlineField,{labelWidth:14,label:"Mode",children:Object(k.jsx)(q.Select,{menuShouldPortal:!0,options:ce,onChange:t=>{a(de({},e,{mode:t.value}))},width:32,value:ce.find(a=>a.value===e.mode)})}),Object(k.jsx)(q.InlineField,{label:"Period",children:Object(k.jsx)(q.Input,{value:e.period,placeholder:"30m",onChange:t=>{a(de({},e,{period:t.currentTarget.value}))}})})]}),Object(k.jsxs)(q.InlineFieldRow,{children:[Object(k.jsx)(q.InlineField,{labelWidth:14,label:"Fields",children:Object(k.jsx)(q.Select,{menuShouldPortal:!0,options:pe,onChange:t=>{a(de({},e,{fields:t.map(e=>e.value)}))},width:32,isMulti:!0,placeholder:"all",value:e.fields})}),Object(k.jsx)(q.InlineField,{label:"States",grow:!0,children:Object(k.jsx)(q.Select,{menuShouldPortal:!0,options:me,onChange:t=>{a(de({},e,{states:t.map(e=>e.value)}))},isMulti:!0,placeholder:"all",value:e.states})})]})]})}const ce=["values-as-rows","values-as-fields","values-as-labeled-fields","timeseries","timeseries-wide"].map(e=>({label:e,value:e})),pe=["foo","bar","baz"].map(e=>({label:e,value:e})),me=["AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","MD","MA","MI","MN","MS","MO","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"].map(e=>({label:e,value:e}));var he,be,ve,ge;function fe(){return(fe=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}const ye=["random_walk","predictable_pulse"],je=[{value:"datasources",label:"Data Sources"},{value:"search",label:"Search"},{value:"annotations",label:"Annotations"}],Fe=$.a.components.DataSource.TestData.QueryTab;var xe=t("xbdB");function Oe(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}t.d(a,"plugin",(function(){return Ce}));class we{constructor(){Oe(this,"annotation",void 0)}}Oe(we,"template","<h2>Annotation scenario</h2>");const Ce=new n.DataSourcePlugin(C).setConfigEditor(M).setQueryEditor(({query:e,datasource:a,onChange:t,onRunQuery:n})=>{var r,l;e=fe({},B,e);const{loading:s,value:i}=Object(V.a)(async()=>{if("manual_entry"===e.scenarioId&&e.points){let a="Time,Value\n";for(const t of e.points)a+=`${t[1]},${t[0]}\n`;t({refId:e.refId,datasource:e.datasource,scenarioId:"csv_content",csvContent:a})}return a.getScenarios()},[]),o=e=>{t(e),n()},d=Object(D.useMemo)(()=>null==i?void 0:i.find(a=>a.id===e.scenarioId),[i,e]),u=null==d?void 0:d.id,c=a=>{const{name:t,value:n,type:r}=a.target;let l=n;"number"===r&&(l=Number(n)),"levelColumn"===t&&(l=a.target.checked),o(fe({},e,{[t]:l}))},p=a=>t=>{const{name:n,value:r,type:l}=t.target;let s=r;"number"===l&&(s=Number(r)),o(fe({},e,{[a]:fe({},e[a],{[n]:s})}))},m=p("stream"),h=p("pulseWave"),b=Object(D.useMemo)(()=>(i||[]).map(e=>({label:e.name,value:e.id})).sort((e,a)=>e.label.localeCompare(a.label)),[i]),g=Object(D.useMemo)(()=>ye.includes(e.scenarioId),[e]);return s?null:Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(q.InlineFieldRow,{"aria-label":Fe.scenarioSelectContainer,children:[Object(k.jsx)(q.InlineField,{labelWidth:14,label:"Scenario",children:Object(k.jsx)(q.Select,{menuShouldPortal:!0,options:b,value:b.find(a=>a.value===e.scenarioId),onChange:a=>{const t=null==i?void 0:i.find(e=>e.id===a.value);if(!t)return;const n={scenarioId:a.value,refId:e.refId,alias:e.alias};switch(t.stringInput&&(n.stringInput=t.stringInput),t.id){case"grafana_api":n.stringInput="datasources";break;case"streaming_client":n.stream=v;break;case"live":n.channel="random-2s-stream";break;case"predictable_pulse":n.pulseWave=U;break;case"predictable_csv_wave":n.csvWave=z;break;case"usa":n.usa={mode:ce[0].value}}o(n)},width:32})}),(null==d?void 0:d.stringInput)&&Object(k.jsx)(q.InlineField,{label:"String Input",children:Object(k.jsx)(q.Input,{width:32,id:"stringInput-"+e.refId,name:"stringInput",placeholder:e.stringInput,value:e.stringInput,onChange:c})}),Object(k.jsx)(q.InlineField,{label:"Alias",labelWidth:14,children:Object(k.jsx)(q.Input,{width:32,id:"alias-"+e.refId,type:"text",placeholder:"optional",pattern:'[^<>&\\\\"]+',name:"alias",value:e.alias,onChange:c})}),g&&Object(k.jsx)(q.InlineField,{label:"Labels",labelWidth:14,tooltip:Object(k.jsxs)(k.Fragment,{children:["Set labels using a key=value syntax:",he||(he=Object(k.jsx)("br",{})),'{ key = "value", key2 = "value" }',be||(be=Object(k.jsx)("br",{})),'key="value", key2="value"',ve||(ve=Object(k.jsx)("br",{})),"key=value, key2=value",ge||(ge=Object(k.jsx)("br",{}))]}),children:Object(k.jsx)(q.Input,{width:32,id:"labels-"+e.refId,name:"labels",onChange:c,value:null===(r=e)||void 0===r?void 0:r.labels,placeholder:"key=value, key2=value2"})})]}),"random_walk"===u&&Object(k.jsx)(E,{onChange:c,query:e}),"streaming_client"===u&&Object(k.jsx)(W,{onChange:m,query:e}),"live"===u&&Object(k.jsx)(ae,{onChange:o,query:e}),"csv_file"===u&&Object(k.jsx)(se,{onChange:o,query:e}),"csv_content"===u&&Object(k.jsx)(oe,{onChange:o,query:e}),"logs"===u&&Object(k.jsxs)(q.InlineFieldRow,{children:[Object(k.jsx)(q.InlineField,{label:"Lines",labelWidth:14,children:Object(k.jsx)(q.Input,{type:"number",name:"lines",value:e.lines,width:32,onChange:c,placeholder:"10"})}),Object(k.jsx)(q.InlineField,{label:"Level",labelWidth:14,children:Object(k.jsx)(q.InlineSwitch,{onChange:c,name:"levelColumn",value:!!e.levelColumn})})]}),"usa"===u&&Object(k.jsx)(ue,{onChange:a=>{o(fe({},e,{usa:a}))},query:null!==(l=e.usa)&&void 0!==l?l:{}}),"grafana_api"===u&&Object(k.jsx)(q.InlineField,{labelWidth:14,label:"Endpoint",children:Object(k.jsx)(q.Select,{menuShouldPortal:!0,options:je,onChange:({value:a})=>{o(fe({},e,{stringInput:a}))},width:32,value:je.find(a=>a.value===e.stringInput)})}),"arrow"===u&&Object(k.jsx)(q.InlineField,{grow:!0,children:Object(k.jsx)(q.TextArea,{name:"stringInput",value:e.stringInput,rows:10,placeholder:"Copy base64 text data from query result",onChange:c})}),"predictable_pulse"===u&&Object(k.jsx)(H,{onChange:h,query:e}),"predictable_csv_wave"===u&&Object(k.jsx)(X,{onChange:a=>{o(fe({},e,{csvWave:a}))},waves:e.csvWave}),"node_graph"===u&&Object(k.jsx)(ne,{onChange:a=>t(fe({},e,{nodes:a})),query:e})]})}).setChannelSupport(new xe.a).setAnnotationQueryCtrl(we).addConfigPage({title:"Setup",icon:"list-ul",body:A,id:"setup"})}}]);
//# sourceMappingURL=testDataDSPlugin.807b3f41627421e0a149.js.map